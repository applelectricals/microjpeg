import{f as J,j as e,X,h as xe,U as he,e as ue,r as m,s as pe}from"./index-BmEBa6jd.js";import{B as j}from"./button-COO6ib03.js";import{C as O}from"./card-BgNaLGW4.js";import{g as ge,a as q,H as K,v as fe}from"./header-CP-hfreY.js";import{S as be}from"./SEOHead-CsE8-pdF.js";import{B as je}from"./badge-CuPpUXPF.js";import{D as _}from"./download-rk2iBLI5.js";import{C as Z}from"./crown-9JI-gxDo.js";import{C as N}from"./check-ClNaaFQm.js";import{U as ve}from"./upload-DGablsAD.js";import"./mascot-logo-optimized-BQMFnuQ8.js";import"./calendar-DaE1gtfS.js";import"./clock-avNKhVX2.js";const B=i=>{if(i===0)return"0 Bytes";const u=1024,o=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(i)/Math.log(u));return parseFloat((i/Math.pow(u,r)).toFixed(2))+" "+o[r]};function we({modalState:i,isProcessing:u,processingProgress:o,processingFileIds:r,selectedFiles:a,session:s,showPricingCards:c,fromFormatName:y,toFormatName:R,operationType:I,onDownloadAll:U,onClose:H}){if(J(),i==="hidden")return null;const D=()=>u?I==="compress"?`Compressing your ${y.toUpperCase()} files...`:`Converting your ${y.toUpperCase()} files to ${R.toUpperCase()}...`:"Your optimized images are ready!";return e.jsx("div",{className:"w-full max-w-6xl mx-auto mt-4 mb-8",children:e.jsx(O,{className:"w-full bg-white shadow-2xl rounded-2xl border border-gray-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 p-4 rounded-t-2xl -m-6 mb-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-lg font-semibold text-white",children:D()}),u&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 border-4 border-white border-t-transparent rounded-full animate-spin"}),e.jsxs(je,{variant:"secondary",className:"bg-white/20 text-white",children:[Math.floor(o),"%"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[s.results.length>0&&e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(j,{className:"bg-brand-gold hover:bg-brand-gold-dark text-white",onClick:U,"data-testid":"button-download-all",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Download All"]})}),i==="results"&&e.jsx(j,{variant:"ghost",size:"sm",onClick:H,className:"h-8 w-8 p-0 text-white hover:bg-white/10","data-testid":"button-close-modal",children:e.jsx(X,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"w-full my-4 px-2",children:e.jsxs("div",{className:"flex items-center justify-between min-h-[80px] bg-gradient-to-r from-blue-50 to-indigo-50 rounded border-2 border-blue-200 px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-bold text-blue-900 mb-1",children:"⚡ Process 1000s of Images in Minutes with Our API"}),e.jsx("p",{className:"text-xs text-blue-700",children:"Bulk compression • 90% cost reduction • Auto-format conversion • Enterprise-grade reliability"})]})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsx(j,{size:"sm",variant:"outline",className:"text-xs px-3 py-1 border-blue-300 text-blue-700 hover:bg-blue-50",onClick:()=>window.location.href="/api-docs",children:"View API Docs"}),e.jsx(j,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white text-xs px-3 py-1",onClick:()=>window.location.href="/simple-pricing",children:"Get API Key"})]})]})}),(s.results.length>=3||c)&&e.jsxs("div",{className:"w-full my-6 px-2",children:[e.jsx("div",{className:"text-center mb-6",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Want to compress larger files? Get ",e.jsx("span",{className:"font-bold",children:"Premium!"})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative bg-white border-2 border-brand-teal rounded-xl overflow-hidden shadow-sm",children:[e.jsx("div",{className:"bg-brand-teal text-white text-center py-2 text-xs font-semibold uppercase tracking-wide",children:"RECOMMENDED FOR YOU"}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-brand-teal/10 rounded-lg flex items-center justify-center",children:e.jsx(Z,{className:"w-5 h-5 text-brand-teal"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold text-gray-900",children:"Test Premium"}),e.jsx("p",{className:"text-xs text-blue-600 font-medium uppercase tracking-wide",children:"COMPRESS & CONVERT"})]})]}),e.jsx("div",{className:"w-10 h-8 bg-blue-100 rounded flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"})})})]}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 bg-brand-teal/10 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(N,{className:"w-3 h-3 text-brand-teal"})}),e.jsxs("span",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-semibold",children:"Unlimited"})," image compression"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 bg-brand-teal/10 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(N,{className:"w-3 h-3 text-brand-teal"})}),e.jsxs("span",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-semibold",children:"50 MB"})," as maximum file size"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 bg-brand-teal/10 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(N,{className:"w-3 h-3 text-brand-teal"})}),e.jsxs("span",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-semibold",children:"All formats"})," including RAW & TIFF"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 bg-brand-teal/10 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(N,{className:"w-3 h-3 text-brand-teal"})}),e.jsx("span",{className:"text-sm text-gray-700",children:"Advanced compression algorithms"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 bg-brand-teal/10 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(N,{className:"w-3 h-3 text-brand-teal"})}),e.jsx("span",{className:"text-sm text-gray-700",children:"API access"})]})]}),e.jsx("div",{className:"flex items-baseline justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-3xl font-bold text-gray-900",children:"$1"}),e.jsx("span",{className:"text-sm text-gray-600 ml-1",children:"24-hour trial"})]})}),e.jsx(j,{className:"w-full bg-brand-teal hover:bg-brand-teal/90 text-white font-medium py-3 rounded-lg",onClick:()=>window.location.href="/subscribe?plan=test-premium",children:"Get Test Premium"})]})]}),e.jsxs("div",{className:"relative bg-white border-2 border-brand-gold rounded-xl overflow-hidden shadow-sm",children:[e.jsx("div",{className:"bg-brand-gold text-white text-center py-4 text-xs font-semibold uppercase tracking-wide"}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-brand-gold/10 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-brand-gold",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M5 16L3 4l5.5 4L12 4l3.5 4L21 4l-2 12H5zm0 0h14v2H5v-2z"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold text-gray-900",children:"Premium"}),e.jsx("p",{className:"text-xs text-blue-600 font-medium uppercase tracking-wide",children:"COMPRESS & CONVERT"})]})]}),e.jsx("div",{className:"w-10 h-8 bg-blue-100 rounded flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"})})})]}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 bg-brand-teal/10 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(N,{className:"w-3 h-3 text-brand-teal"})}),e.jsxs("span",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-semibold",children:"Unlimited"})," image compression"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 bg-brand-teal/10 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(N,{className:"w-3 h-3 text-brand-teal"})}),e.jsxs("span",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-semibold",children:"50 MB"})," as maximum file size"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 bg-brand-teal/10 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(N,{className:"w-3 h-3 text-brand-teal"})}),e.jsxs("span",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-semibold",children:"All formats"})," conversion support"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 bg-brand-teal/10 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(N,{className:"w-3 h-3 text-brand-teal"})}),e.jsx("span",{className:"text-sm text-gray-700",children:"Advanced analytics & reporting"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 bg-brand-teal/10 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(N,{className:"w-3 h-3 text-brand-teal"})}),e.jsx("span",{className:"text-sm text-gray-700",children:"Priority support & API access"})]})]}),e.jsx("div",{className:"flex items-baseline justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-3xl font-bold text-gray-900",children:"$29"}),e.jsx("span",{className:"text-sm text-gray-600 ml-1",children:"Monthly per user"})]})}),e.jsx(j,{className:"w-full bg-brand-gold hover:bg-brand-gold-dark text-white font-medium py-3 rounded-lg",onClick:()=>window.location.href="/subscribe?plan=premium",children:"Get Premium"})]})]})]})]}),a.length>0&&e.jsx("div",{className:"space-y-0",children:e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:i==="processing"&&s.results.length===0?a.map(x=>{const v=r.has(x.id),n=s.results.filter(h=>h.originalName===x.name);return e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg overflow-hidden flex-shrink-0",children:e.jsx("img",{src:URL.createObjectURL(x),alt:x.name,className:"w-full h-full object-cover",onError:h=>{const M=h.currentTarget;M.style.display="none";const g=M.parentElement;g&&(g.className="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center flex-shrink-0",g.innerHTML='<svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>')}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-brand-dark",children:x.name.length>20?`${x.name.substring(0,20)}...`:x.name}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[B(x.size)," • ",v?"Processing...":n.length>0?`${n.length} format${n.length>1?"s":""} ready`:"Queued..."]}),v&&s.results.length===0&&e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1",children:e.jsx("div",{className:"bg-brand-teal h-1 rounded-full transition-all duration-300 animate-pulse",style:{width:`${Math.floor(o)}%`}})})]})]}),e.jsx("div",{className:"flex items-center gap-3 flex-wrap flex-shrink-0",children:v?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-brand-teal border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Processing..."})]}):n.length>0?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsx("span",{className:"text-sm text-green-600",children:"Ready"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})})}),e.jsx("span",{className:"text-sm text-gray-500",children:"Queued"})]})})]})})},x.id)}):s.results.length>0&&a.map(x=>{var n;const v=s.results.filter(h=>h.originalName===x.name);return v.length===0?null:e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg overflow-hidden flex-shrink-0",children:e.jsx("img",{src:((n=v[0])==null?void 0:n.downloadUrl)||URL.createObjectURL(x),alt:x.name,className:"w-full h-full object-cover",onError:h=>{const M=h.currentTarget;M.style.display="none";const g=M.parentElement;g&&(g.className="w-16 h-16 bg-gradient-to-br from-green-500 to-blue-600 rounded-lg flex items-center justify-center flex-shrink-0",g.innerHTML='<svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>')}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-brand-dark mb-1",children:x.name.length>20?`${x.name.substring(0,20)}...`:x.name}),e.jsx("div",{className:"space-y-1",children:v.map(h=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[B(h.originalSize)," → ",B(h.compressedSize),e.jsxs("span",{className:"text-green-600 font-medium ml-1",children:["(",h.compressionRatio,"% smaller)"]})]}),e.jsx(j,{size:"sm",variant:"outline",onClick:()=>window.open(h.downloadUrl,"_blank"),"data-testid":`button-download-${h.id}`,className:"ml-2",children:e.jsx(_,{className:"w-3 h-3"})})]},h.id))})]})]})})},x.id)})})})]})})})}const Ne=(i,u)=>new Promise(o=>{let r=0;const a=i/100,s=setInterval(()=>{r+=Math.random()*3+1,r>=100?(r=100,clearInterval(s),u(100),setTimeout(o,500)):u(Math.floor(r))},a)}),ye=(i,u)=>{if(i.conversion){const s=i.conversion.match(/^([a-z0-9]+)-to-([a-z0-9]+)$/);if(s){const[,c,y]=s;return{from:c,to:y,operation:"convert"}}}if(i.format){const s=i.format.match(/^([a-z0-9]+)-to-([a-z0-9]+)$/);if(s){const[,c,y]=s;return c===y?(console.warn(`Malformed compress route detected: /tools/${i.format}. Redirecting to /tools/${c}`),window.location.replace(`/tools/${c}`),null):(console.warn(`Malformed compress route detected: /tools/${i.format}. Redirecting to /convert/${i.format}`),window.location.replace(`/convert/${i.format}`),null)}return{from:i.format,to:i.format,operation:"compress"}}const o=u.match(/\/convert\/([a-z0-9]+)-to-([a-z0-9]+)$/),r=u.match(/\/tools\/([a-z0-9]+)$/),a=u.match(/\/tools\/([a-z0-9]+)-to-([a-z0-9]+)$/);if(a){const[,s,c]=a;return s===c?(console.warn(`Malformed compress URL detected: ${u}. Redirecting to /tools/${s}`),window.location.replace(`/tools/${s}`),null):(console.warn(`Malformed compress URL detected: ${u}. Redirecting to /convert/${s}-to-${c}`),window.location.replace(`/convert/${s}-to-${c}`),null)}if(o){const[,s,c]=o;return{from:s,to:c,operation:"convert"}}if(r){const[,s]=r;return{from:s,to:s,operation:"compress"}}return null};function Ee(){const[i]=xe(),u=he(),{toast:o}=J();ue();const r=ye(u,i),a=r?ge(r.from,r.to):null,s=r?q(r.from):null,c=r?q(r.to):null;if(!r||!a||!s||!c)return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-brand-cream via-white to-brand-light flex flex-col",children:[e.jsx(K,{}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404 - Conversion Not Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"The conversion format you're looking for doesn't exist."}),e.jsx("a",{href:"/tools/convert",className:"text-blue-600 hover:underline",children:"Browse available conversions"})]})})]});const[y,R]=m.useState([]),[I,U]=m.useState([]),[H,D]=m.useState(new Map),[x,v]=m.useState(!1),[n,h]=m.useState(!1),[M,g]=m.useState("hidden"),[V,T]=m.useState(!1),[G,ee]=m.useState(0),[se,A]=m.useState(0),[te,Q]=m.useState(new Set),[P,ae]=m.useState(a.defaultQuality),[$,re]=m.useState(a.defaultSize),W=m.useRef(null),[F,le]=m.useState({compressions:0,conversions:0,uploadedFiles:[],results:[],showPricingProbability:0,activityScore:0}),Y=m.useCallback(t=>fe(t,r.from),[r]),ne=m.useCallback(()=>{var t;n||(t=W.current)==null||t.click()},[n]),E=m.useCallback(t=>{if(n){o({title:"Processing in progress",description:"Please wait for current conversion to complete.",variant:"destructive"});return}const f=Array.from(t),p=[],l=[];if(f.forEach(k=>{const b=Y(k);if(b)l.push(b);else{const C=Object.assign(k,{id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`});p.push(C)}}),l.length>0&&o({title:"File validation errors",description:l.join(`
`),variant:"destructive"}),p.length>0){D(b=>{const C=new Map(b);return p.forEach(z=>{C.set(z.name,URL.createObjectURL(z))}),C}),R(b=>[...b,...p]),U(p),pe.trackActivity(),setTimeout(()=>ie(p),100);const k=a.operation==="compress"?"Compressing":"Converting";o({title:`Files added - ${k}...`,description:`${p.length} file(s) added. ${k} ${s.displayName} to ${c.displayName} automatically.`})}},[n,o,Y,a,s,c]),ie=m.useCallback(async t=>{var p;const f=t||y;if(f.length!==0){h(!0),g("processing"),A(0),Q(new Set(f.map(l=>l.id)));try{const l=await fetch("/api/universal-usage-stats",{method:"GET",credentials:"include",cache:"no-store"});if(l.ok){const k=await l.json(),b=s.category==="raw"?"raw":"standard",C=((p=k.stats)==null?void 0:p[b])||{},{used:z=0,limit:S=5}=C.hourly||{},{used:w=0,limit:d=10}=C.daily||{};if(z>=S){const me=new Date(Date.now()+36e5).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});o({title:"Hourly Limit Reached",description:`You've reached your hourly limit of ${S} ${b} operations. Please try again after ${me}, or upgrade for unlimited access!`,variant:"destructive"}),h(!1),g("hidden");return}if(w>=d){o({title:"Daily Limit Reached",description:`You've reached your daily limit of ${d} ${b} operations. Limit resets at midnight, or upgrade for unlimited access!`,variant:"destructive"}),h(!1),g("hidden");return}}}catch(l){console.log("Could not check limits:",l)}try{const l=new FormData;f.forEach(w=>{l.append("files",w)}),l.append("outputFormat",r.to),l.append("quality",P.toString()),l.append("resize",$<100?"true":"false"),l.append("resizePercentage",$.toString()),$>=100&&(l.append("width","2560"),l.append("height","2560"),l.append("maintainAspect","true")),l.append("pageIdentifier",a.pageIdentifier);const k=a.endpoint,b=s.category==="raw"?Math.max(3e4,f.length*15e3):Math.max(1e4,f.length*5e3),C=Ne(b,w=>{A(w)}),z=await fetch(k,{method:"POST",body:l});if(await C,!z.ok){const w=await z.json();throw new Error(w.error||"Conversion failed")}const S=await z.json();if(S.results&&Array.isArray(S.results)){const w=S.results.map(d=>({id:d.id,originalName:d.originalFilename||d.originalName,originalSize:d.originalSize,compressedSize:d.convertedSize||d.compressedSize||d.finalSize,compressionRatio:d.compressionRatio||Math.round((d.originalSize-(d.convertedSize||d.compressedSize||d.finalSize))/d.originalSize*100),downloadUrl:d.downloadUrl||`/api/download/${d.id}`,originalFormat:r.from,outputFormat:r.to,wasConverted:a.operation==="convert"}));le(d=>({...d,results:[...d.results,...w]}))}A(100),g("results"),ee(w=>w+1),G>=2&&T(!0),setTimeout(()=>{window.dispatchEvent(new Event("refreshUniversalCounter"))},500)}catch(l){console.error("Conversion error:",l),o({title:"Conversion failed",description:l instanceof Error?l.message:"Unknown error occurred",variant:"destructive"}),g("hidden")}finally{h(!1),Q(new Set),window.dispatchEvent(new Event("refreshUniversalCounter"))}}},[y,G,o,a,s,r,P,$]),oe=m.useCallback(async()=>{if(F.results.length===0){o({title:"No files to download",description:"Please process some files first.",variant:"destructive"});return}try{const t=F.results.map(l=>l.id),f=await fetch("/api/create-session-zip",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resultIds:t})});if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);const p=await f.json();if(p.error)throw new Error(p.error);window.open(p.batchDownloadUrl,"_blank"),T(!0),o({title:"Download started",description:`Creating ZIP with ${p.fileCount} files...`})}catch(t){console.error("Download all error:",t),o({title:"Download failed",description:t instanceof Error?t.message:"Failed to create download",variant:"destructive"})}},[F.results,o]),L=m.useCallback(t=>{t.preventDefault(),t.stopPropagation(),t.type==="dragenter"||t.type==="dragover"?v(!0):t.type==="dragleave"&&v(!1)},[]),ce=m.useCallback(t=>{t.preventDefault(),t.stopPropagation(),v(!1),t.dataTransfer.files&&t.dataTransfer.files[0]&&E(t.dataTransfer.files)},[E]),de=`https://microjpeg.com${i}`;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-brand-cream via-white to-brand-light flex flex-col",children:[e.jsx(be,{title:a.title,description:a.description,canonicalUrl:de,keywords:a.keywords.join(", "),authoritative:!0}),e.jsx(K,{}),e.jsx("section",{className:"flex-1 px-4 pt-20 sm:pt-24 md:pt-28 pb-8 lg:py-16",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16 items-center",children:[e.jsxs("div",{className:"space-y-6 lg:space-y-8 text-center lg:text-left",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl xl:text-4xl font-bold leading-tight",children:a.operation==="compress"?e.jsxs(e.Fragment,{children:["Compress ",e.jsx("span",{className:"text-brand-gold",children:s.displayName})," Online",e.jsx("br",{className:"hidden sm:block"}),e.jsxs("span",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl xl:text-4xl text-gray-700 block sm:inline",children:["Free ",s.category==="raw"&&a.from==="cr2"?"Canon RAW":s.displayName," Compressor"]})]}):e.jsxs(e.Fragment,{children:["Convert ",e.jsx("span",{className:"text-brand-gold",children:s.displayName})," to ",e.jsx("span",{className:"text-brand-teal",children:c.displayName})," Online",e.jsx("br",{className:"hidden sm:block"}),e.jsxs("span",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl xl:text-4xl text-gray-700 block sm:inline",children:["Free ",s.category==="raw"&&a.from==="cr2"?"Canon RAW":s.displayName," Converter"]})]})}),e.jsx("p",{className:"text-base sm:text-lg lg:text-xl text-gray-700 leading-relaxed max-w-2xl mx-auto lg:mx-0",children:a.description})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:a.features.map((t,f)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-brand-teal/10 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(N,{className:"w-5 h-5 text-brand-teal"})}),e.jsx("span",{className:"text-gray-700 font-medium",children:t})]},f))}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center lg:justify-start",children:[e.jsx(j,{size:"lg",onClick:()=>window.location.href="/simple-pricing",className:"w-full sm:w-auto bg-brand-gold hover:bg-brand-gold-dark text-white font-semibold px-8 py-4 text-lg rounded-lg animate-pulse-glow min-h-[48px]","data-testid":"button-plans-pricing",children:"Plans & Pricing"}),e.jsx(j,{size:"lg",variant:"outline",onClick:()=>window.location.href="/subscribe?plan=test-premium",className:"w-full sm:w-auto px-8 py-4 text-lg border-2 border-brand-gold text-brand-dark hover:bg-brand-gold/10 min-h-[48px]","data-testid":"button-try-now",children:"Try Now ($1)"})]})]}),e.jsx("div",{className:"relative mt-8 lg:mt-0 upload-interface w-full",children:e.jsx(O,{className:"p-4 sm:p-6 lg:p-8 bg-white/95 backdrop-blur border-2 border-brand-gold/20 shadow-2xl w-full",children:e.jsxs("div",{className:`relative border-3 border-dashed rounded-xl p-4 sm:p-6 lg:p-8 text-center transition-all duration-300 ${n?"cursor-not-allowed opacity-50 bg-gray-50":x?"border-brand-teal bg-brand-teal/5 scale-105 cursor-pointer":"border-gray-300 hover:border-brand-gold hover:bg-brand-cream/50 cursor-pointer"}`,onDragEnter:n?void 0:L,onDragLeave:n?void 0:L,onDragOver:n?void 0:L,onDrop:n?void 0:ce,onClick:n?void 0:ne,title:n?"Please wait - conversion in progress...":"",children:[e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-brand-teal/10 rounded-xl mx-auto flex items-center justify-center",children:e.jsx(ve,{className:"w-6 h-6 sm:w-8 sm:h-8 text-brand-teal"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm sm:text-base font-medium text-gray-700",children:["Drop ",s.displayName," files here or click to upload"]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:a.operation==="compress"?`Compress ${s.displayName} files`:`Convert ${s.displayName} files to ${c.displayName} format`}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.extensions.map(t=>t.toUpperCase()).join(", ")," files only"]})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Size"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[$,"%"]})]}),e.jsx("input",{type:"range",min:"25",max:"100",value:$,onChange:t=>re(Number(t.target.value)),disabled:n,className:`w-full h-2 bg-gray-200 rounded-lg appearance-none ${n?"cursor-not-allowed opacity-50":"cursor-pointer"}`,style:{background:`linear-gradient(to right, #D4AF37 0%, #D4AF37 ${$}%, #e5e5e5 ${$}%, #e5e5e5 100%)`}})]}),c.supportsQuality&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Quality"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[P,"%"]})]}),e.jsx("input",{type:"range",min:"10",max:"100",value:P,onChange:t=>ae(Number(t.target.value)),disabled:n,className:`w-full h-2 bg-gray-200 rounded-lg appearance-none ${n?"cursor-not-allowed opacity-50":"cursor-pointer"}`,style:{background:`linear-gradient(to right, #D4AF37 0%, #D4AF37 ${P}%, #e5e5e5 ${P}%, #e5e5e5 100%)`}})]})]})})]}),e.jsx("input",{ref:W,type:"file",accept:s.extensions.map(t=>`.${t}`).join(","),multiple:!0,className:"hidden",onChange:t=>{t.target.files&&E(t.target.files)},"data-testid":"file-input"})]})})})]})})}),e.jsx(we,{modalState:M,isProcessing:n,processingProgress:se,processingFileIds:te,selectedFiles:y,session:F,showPricingCards:V,fromFormatName:s.displayName,toFormatName:c.displayName,operationType:a.operation,onDownloadAll:oe,onClose:()=>g("hidden")}),V&&e.jsx("div",{className:"fixed bottom-4 right-4 z-40",children:e.jsxs(O,{className:"p-4 bg-white/95 backdrop-blur border-2 border-brand-gold/20 shadow-xl max-w-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5 text-brand-gold"}),e.jsx("h4",{className:"font-semibold text-sm",children:"Upgrade for More"})]}),e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>T(!1),className:"h-6 w-6 p-0",children:e.jsx(X,{className:"w-3 h-3"})})]}),e.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Get unlimited conversions and larger file sizes"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{size:"sm",className:"flex-1 bg-brand-gold hover:bg-brand-gold-dark text-white text-xs",onClick:()=>window.location.href="/simple-pricing",children:"View Plans"}),e.jsx(j,{size:"sm",variant:"outline",className:"flex-1 text-xs",onClick:()=>window.location.href="/subscribe?plan=test-premium",children:"Try $1"})]})]})})]})}export{Ee as default};
