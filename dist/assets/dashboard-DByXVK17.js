import{e as w,f as C,h as k,r as P,l as g,j as e,X as B,k as F,q as S}from"./index-BmEBa6jd.js";import{u as A}from"./useMutation-DR4V7Yvb.js";import{B as o}from"./button-COO6ib03.js";import{C as n,a as c,b as d,d as m}from"./card-BgNaLGW4.js";import{B as t}from"./badge-CuPpUXPF.js";import{A as D,a as E}from"./alert-Cwr1IrGR.js";import{C as x}from"./crown-9JI-gxDo.js";import{C as L}from"./credit-card-K3L1u0Mu.js";import{C as q}from"./circle-alert-Ca10OTDr.js";import{C as M}from"./chart-column-BI8flbNt.js";import{Z as U}from"./zap-BJ-kN9H2.js";import{C as r}from"./circle-check-big-D_tWOXDK.js";import{S as T}from"./settings-DwiN5qNC.js";import{D as z}from"./download-rk2iBLI5.js";function $(l){return/^401: .*Unauthorized/.test(l.message)}function ee(){w();const{toast:l}=C(),[,h]=k(),[j,u]=P.useState(!1),{data:s,isLoading:N}=g({queryKey:["/api/subscription-info"],retry:!1}),{data:a,isLoading:b}=g({queryKey:["/api/compression-limits"],retry:!1}),f=A({mutationFn:async()=>{await F("POST","/api/cancel-subscription")},onSuccess:()=>{l({title:"Subscription Cancelled",description:"Your subscription will remain active until the end of the current billing period."}),S.invalidateQueries({queryKey:["/api/subscription-info"]})},onError:i=>{if($(i)){l({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{window.location.href="/api/login"},500);return}l({title:"Error",description:"Failed to cancel subscription. Please try again.",variant:"destructive"})}}),y=()=>{u(!0),f.mutate(),u(!1)},p=i=>i?new Date(i).toLocaleDateString():"N/A",v=i=>{switch(i){case"active":return e.jsx(t,{className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"Active"});case"canceled":return e.jsx(t,{className:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:"Cancelled"});case"past_due":return e.jsx(t,{className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:"Past Due"});default:return e.jsx(t,{variant:"secondary",children:"Free"})}};return N||b?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Loading dashboard..."})]})})}):e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Subscription Dashboard"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Manage your subscription and view usage statistics"})]}),e.jsx("div",{className:"flex items-center gap-2",children:s!=null&&s.isPremium?e.jsxs(t,{className:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 flex items-center gap-1",children:[e.jsx(x,{className:"w-4 h-4"}),"Premium"]}):e.jsx(t,{variant:"secondary",children:"Free Plan"})})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(n,{children:[e.jsx(c,{children:e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"}),"Current Plan"]})}),e.jsx(m,{children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"font-medium",children:"Plan Type"}),s!=null&&s.isPremium?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{className:"font-semibold",children:"Premium"})]}):e.jsx("span",{className:"font-semibold",children:"Free"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"font-medium",children:"Status"}),v(s==null?void 0:s.subscriptionStatus)]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"Monthly Cost"}),e.jsx("span",{className:"font-semibold",children:s!=null&&s.isPremium?"$9.99":"$0.00"})]})]}),e.jsx("div",{children:(s==null?void 0:s.isPremium)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"font-medium",children:"Next Billing Date"}),e.jsx("span",{children:p(s.currentPeriodEnd)})]}),s.cancelAtPeriodEnd&&e.jsxs(D,{className:"border-yellow-200 bg-yellow-50 dark:border-yellow-800 dark:bg-yellow-900/20",children:[e.jsx(q,{className:"h-4 w-4 text-yellow-600"}),e.jsxs(E,{className:"text-yellow-800 dark:text-yellow-200",children:["Your subscription will end on ",p(s.currentPeriodEnd)]})]})]})})]})})]}),e.jsxs(n,{children:[e.jsx(c,{children:e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5"}),"Usage Statistics"]})}),e.jsxs(m,{children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:(a==null?void 0:a.compressions)||0}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Compressions"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:a!=null&&a.isPremium?"No limit":"10MB"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"File Size Limit"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:a!=null&&a.isPremium?"Premium":"Free"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Plan Type"})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a!=null&&a.isPremium?"Premium: Unlimited compressions with no file size restrictions":"Free: Unlimited compressions with 10MB file size limit"})})})]})]}),e.jsxs(n,{children:[e.jsx(c,{children:e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5"}),"Plan Features"]})}),e.jsx(m,{children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:["Free Plan",e.jsx(t,{variant:"secondary",children:"$0/month"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm",children:"5 compressions per day"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm",children:"Basic quality settings"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm",children:"JPEG output format"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Batch processing"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[e.jsx(x,{className:"w-4 h-4 text-yellow-500"}),"Premium Plan",e.jsx(t,{className:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:"$9.99/month"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Unlimited compressions"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Advanced quality controls"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Multiple output formats"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Batch processing"})]})]})]})]})})]}),e.jsxs(n,{children:[e.jsx(c,{children:e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5"}),"Manage Subscription"]})}),e.jsx(m,{children:e.jsx("div",{className:"flex flex-wrap gap-4",children:s!=null&&s.isPremium?e.jsxs(e.Fragment,{children:[!s.cancelAtPeriodEnd&&e.jsx(o,{onClick:y,variant:"outline",disabled:j,className:"border-red-200 text-red-600 hover:bg-red-50 dark:border-red-800 dark:text-red-400 dark:hover:bg-red-900/20",children:j?"Cancelling...":"Cancel Subscription"}),e.jsxs(o,{onClick:()=>h("/"),className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Start Compressing"]})]}):e.jsxs(o,{onClick:()=>h("/subscribe"),className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(x,{className:"w-4 h-4 mr-2"}),"Upgrade to Premium"]})})})]})]})]})})}export{ee as default};
